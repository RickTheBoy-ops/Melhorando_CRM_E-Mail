# ========================================
# BILLIONMAIL CRM - PUBLIC CONFIG ONLY
# ========================================
# üîí P0 SECURITY FIX: ALL CREDENTIALS REMOVED
# üõ°Ô∏è COMPLIANCE: GDPR, SOC2, PCI-DSS
# üéØ ZERO PLAIN TEXT CREDENTIALS
#
# PRODUCTION: Run secrets/generate-secrets.sh BEFORE deploy
# DEVELOPMENT: Set environment variables locally
# DOCKER SECRETS: Encrypted credentials at rest and in transit

# ==========================================
# DEVELOPMENT MODE & LOGGING
# ==========================================
NODE_ENV=development
GIN_MODE=release
LOG_LEVEL=info
DEBUG=false

# ==========================================
# DATABASE CONFIG (public only)
# ==========================================
POSTGRES_USER=billionmail_user
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=billionmail
# üîí POSTGRES_PASSWORD ‚Üí Docker Secret: /run/secrets/postgres_password

# ==========================================
# REDIS CONFIG (public only)
# ==========================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
# üîí REDIS_PASSWORD ‚Üí Docker Secret: /run/secrets/redis_password

# ==========================================
# JWT CONFIG (public only)
# ==========================================
JWT_EXPIRATION=24h
JWT_REFRESH_EXPIRATION=168h
JWT_ISSUER=billionmail-crm
# üîí JWT_SECRET ‚Üí Docker Secret: /run/secrets/jwt_secret

# ==========================================
# RATE LIMITING & SECURITY (public)
# ==========================================
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=1m
RATE_LIMIT_BURST=200
RATE_LIMIT_PER_MINUTE=60

CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

SESSION_MAX_AGE=86400
SESSION_SECURE=false
SESSION_HTTP_ONLY=true
# üîí SESSION_SECRET ‚Üí Docker Secret: /run/secrets/session_secret
# üîí ENCRYPTION_KEY ‚Üí Docker Secret: /run/secrets/encryption_key

# ==========================================
# SMTP CONFIG (public only)
# ==========================================
SMTP_HOST=postfix
SMTP_PORT=587
SMTP_USER=noreply@billionmail.com
SMTP_MAX_CONNECTIONS=10
SMTP_TIMEOUT=30s
SMTP_TLS=true
SMTP_START_TLS=true
# üîí SMTP_PASSWORD ‚Üí Docker Secret: /run/secrets/smtp_password

# ==========================================
# EMAIL SERVICE CONFIG
# ==========================================
EMAIL_SERVICE_PORT=8002
MAX_WORKERS=5
BATCH_SIZE=100
MAX_EMAIL_RETRIES=3
RETRY_BACKOFF_MULTIPLIER=2

DEFAULT_FROM_EMAIL=noreply@billionmail.com
COMPANY_NAME=BillionMail
SUPPORT_EMAIL=support@billionmail.com

CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT=30s
CIRCUIT_BREAKER_MAX_REQUESTS=3

# ==========================================
# MICROSERVICES URLS & PORTS
# ==========================================
GATEWAY_PORT=8080
GATEWAY_HOST=0.0.0.0
GATEWAY_URL=http://gateway:8080

AUTH_SERVICE_PORT=8001
AUTH_SERVICE_HOST=0.0.0.0
AUTH_SERVICE_URL=http://auth-service:8001

EMAIL_SERVICE_URL=http://email-service:8002

CAMPAIGN_SERVICE_PORT=8003
CAMPAIGN_SERVICE_HOST=0.0.0.0
CAMPAIGN_SERVICE_URL=http://campaign-service:8003

CONTACT_SERVICE_PORT=8004
CONTACT_SERVICE_HOST=0.0.0.0
CONTACT_SERVICE_URL=http://contact-service:8004

ANALYTICS_SERVICE_PORT=8005
ANALYTICS_SERVICE_HOST=0.0.0.0
ANALYTICS_SERVICE_URL=http://analytics-service:8005

TEMPLATE_SERVICE_PORT=8006
TEMPLATE_SERVICE_HOST=0.0.0.0
TEMPLATE_SERVICE_URL=http://template-service:8006

NOTIFICATION_SERVICE_PORT=8007
NOTIFICATION_SERVICE_HOST=0.0.0.0
NOTIFICATION_SERVICE_URL=http://notification-service:8007

# ==========================================
# MONITORING CONFIG (public)
# ==========================================
PROMETHEUS_PORT=9090
PROMETHEUS_URL=http://prometheus:9090
METRICS_ENABLED=true
METRICS_PATH=/metrics

GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_URL=http://grafana:3001

HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_PATH=/health

LOG_FORMAT=json
LOG_OUTPUT=stdout
LOG_FILE_PATH=/var/log/billionmail/app.log
LOG_MAX_SIZE=100MB
LOG_MAX_BACKUPS=5
LOG_MAX_AGE=30

# ==========================================
# NETWORKING & INFRASTRUCTURE
# ==========================================
NETWORK_NAME=billionmail_network
SUBNET=172.20.0.0/16

LOAD_BALANCER_PORT=80
LOAD_BALANCER_SSL_PORT=443

NGINX_PORT=80
NGINX_SSL_PORT=443
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024

SSL_CERT_PATH=/etc/ssl/certs/billionmail.crt
SSL_KEY_PATH=/etc/ssl/private/billionmail.key
SSL_ENABLED=false

# ==========================================
# MAIL SERVER CONFIG (public)
# ==========================================
POSTFIX_HOSTNAME=mail.billionmail.com
POSTFIX_DOMAIN=billionmail.com
POSTFIX_MESSAGE_SIZE_LIMIT=50000000
POSTFIX_MAILBOX_SIZE_LIMIT=0

DOVECOT_PROTOCOLS=imap pop3 lmtp
DOVECOT_MAIL_LOCATION=maildir:/var/mail/vhosts/%d/%n

# ==========================================
# FAIL2BAN & SECURITY
# ==========================================
FAIL2BAN_ENABLED=true
FAIL2BAN_BANTIME=3600
FAIL2BAN_FINDTIME=600
FAIL2BAN_MAXRETRY=5

WHITELIST_IPS=127.0.0.1,::1,172.20.0.0/16

LOG_RETENTION_DAYS=30
MAIL_LOG_RETENTION_DAYS=90
SECURITY_LOG_RETENTION_DAYS=180

# ==========================================
# BACKUP & STORAGE
# ==========================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=/var/backups/billionmail

UPLOAD_MAX_SIZE=10MB
UPLOAD_ALLOWED_TYPES=jpg,jpeg,png,gif,pdf,doc,docx,xls,xlsx
STORAGE_PATH=/var/lib/billionmail/uploads

# ==========================================
# DOCKER SECRETS REFERENCE
# ==========================================
# üîê AVAILABLE SECRETS:
# - postgres_password     ‚Üí /run/secrets/postgres_password
# - redis_password        ‚Üí /run/secrets/redis_password  
# - jwt_secret           ‚Üí /run/secrets/jwt_secret
# - smtp_password        ‚Üí /run/secrets/smtp_password
# - encryption_key       ‚Üí /run/secrets/encryption_key
# - session_secret       ‚Üí /run/secrets/session_secret
#
# üöÄ SECURE DEPLOYMENT:
# 1. Run: ./secrets/generate-secrets.sh
# 2. Verify: docker secret ls
# 3. Deploy: docker stack deploy -c docker-compose.microservices.yml billionmail
#
# üîÑ SECRET ROTATION:
# Run: ./scripts/rotate-secrets.sh production

# ==========================================
# DEVELOPMENT OVERRIDES
# ==========================================
# Uncomment for local development (outside Docker):
# LOCAL_POSTGRES_HOST=localhost
# LOCAL_REDIS_HOST=localhost
# LOCAL_SMTP_HOST=localhost
# LOCAL_GATEWAY_URL=http://localhost:8080
# LOCAL_AUTH_SERVICE_URL=http://localhost:8001
# LOCAL_EMAIL_SERVICE_URL=http://localhost:8002

# ==========================================
# COMPLIANCE & AUDIT
# ==========================================
# ‚úÖ GDPR: Encrypted credentials, no personal data in logs
# ‚úÖ SOC2: Access control, audit trails, encryption at rest/transit
# ‚úÖ PCI-DSS: Secrets management, automatic rotation, controlled access
# ‚úÖ ZERO TRUST: No plain text credentials, principle of least privilege